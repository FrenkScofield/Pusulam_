<head>
    <script src="../../../Scripts/Tools.js"></script>
    <script src="../../../Scripts/Rapor/amcharts.js"></script>
    <script src="../../../Scripts/Rapor/jquery.easypiechart.js"></script>
    <script src="../../../Scripts/Rapor/light.js"></script>
    <script src="../../../Scripts/Rapor/serial.js"></script>
    <script src="../../../Scripts/Rapor/pie.js"></script>
</head>
<style>
    .progressbar {
        width: 400px;
        height: 30px;
    }

    .progressbarlabel {
        width: 300px;
        height: 21px;
        position: absolute;
        text-align: center;
        font-size: small;
    }

    #chartdiv {
        width: 100%;
        height: 500px;
        font-size: 11px;
    }
</style>


<div class="page-head">
    <!-- BEGIN PAGE TITLE -->
    <div class="page-title col-md-12">
        <h1>
            Sınav Konu Analiz <small>Sınav Sonuç Konu Analizleri</small> <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span>
        </h1>
    </div>
    <!-- END PAGE TITLE -->
</div>

<div class="row" id="app">	
	<div class="col-md-12">
		<div class="portlet box green-haze dd-item" style="border:none">
			<div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filters' style="cursor:pointer;">
				<div class="caption">
					<i class="icon-magnifier"></i>
					<span class="caption-subject bold uppercase"> Filtreler </span>
					<span class="caption-helper"></span>
				</div>
				<div class='actions'>
					<a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
						<i class='fa fa-chevron-down'></i>
					</a>
				</div>
			</div>
			<div class="portlet-body form collapse in" id="filters">
				<form role="form" style="padding:12px 20px">
					<div class="form-body form-group-lg form-horizontal row" style="padding: 0px;margin-top: 0px !important;">
					
    <div class="portlet light col-md-12" id="FiltreDivOgretmen" style="margin:0px; border-bottom-style: solid;border-bottom-width: 3px;border-bottom-color: rgb(0, 173, 239);">
        <div class="portlet-body">
            <div class="form-inline">

                <div class="row">
                    <c-donem controller="OgrenciBelgeKonuAnalizi"
                             @OnChange="DonemSelected">
                    </c-donem>
                    <c-sube controller="OgrenciBelgeKonuAnalizi"
                            @OnChange="SubeSelected">
                    </c-sube>
                    <c-kademe3 controller="OgrenciBelgeKonuAnalizi"
                               :idsube="idsube"
                               @OnChange="Kademe3Selected">
                    </c-kademe3>
                    <c-sinav-turu-obkonuanaliz controller="OgrenciBelgeKonuAnalizi"
                                               :idkademe3="idkademe3"
                                               @OnChange="SinavTuruSelected">
                    </c-sinav-turu-obkonuanaliz>
                    <c-sinav-multi-obkonuanaliz controller="OgrenciBelgeKonuAnalizi"
                                                :idsinavturu="idsinavturu"
                                                :donem="DONEM"
                                                :idkademe3="idkademe3"
                                                @OnChange="SinavSelected">
                    </c-sinav-multi-obkonuanaliz>
                    <c-sinif controller="OgrenciBelgeKonuAnalizi"
                             :idsube="idsube"
                             :idkademe3="idkademe3"
                             @OnChange="SinifSelected">
                    </c-sinif>
                    <c-ogrenci controller="OgrenciBelgeKonuAnalizi"
                               :idsinif="idsinif"
                               @OnChange="OgrenciSelected">
                    </c-ogrenci>
                </div>
                <div class="row">
                    <div class="form-md-line-input">
                        <div class="col-md-3">
                            <label for="limit">% Altı Raporla: </label>
                            <input style="width:100%;" id="limit" type="number" class="form-control" v-model="limit" placeholder="100" max="100" min="0">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-md-line-input">
                        <div class="col-md-3">
                            <label for="limit">Uyarı Yüzde: </label>
                            <input style="width:100%;" id="limit" type="number" class="form-control" v-model="aciklamalimit" placeholder="100" max="100" min="0">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-md-line-input">
                        <div class="col-md-3">
                            <label style="display:block;" for="limit">Uyarı Metni: </label>
                            <textarea id="limit" style="resize:none; width:100%; height:150px;" class="form-control" v-model="aciklama"></textarea>
                        </div>
                    </div>
                </div>
                <input style="float:right;margin: 10px;" type="button" class="btn btn-success" v-on:click="Kaydet" value="Kaydet">
                <input style="float:right;margin: 10px;" type="button" class="btn btn-success" v-on:click="Yazdir" value="Raporla">
            </div>
        </div>
    </div>
					</div>
				</form>
			</div>
		</div>
	</div>
		
</div>

<script src="../../../VueComponents/KonuAnaliziFiltreleri.js?v=3"></script>
<script src="../../../VueComponents/OgrenciBelgeKonuAnaliz.js?v=3"></script>
<script>
    var vue = new Vue({
        el: "#app",
        name: "KonuAnaliz.html",

        data: {
            TCKIMLIKNO: '',
            DONEM: '',
            ID_SINAVS: [],
            idsube: 0,
            idkademe3: 0,
            idsinif: 0,
            tcogrenci: '',
            idsinavturu: [],
            idkullanicitur: 0,
            limit: 100,
            aciklamalimit: 0,
            aciklama: ''
        },

        mounted() {
        },

        methods: {
            Yazdir: function (event) {
                var params = 'Sinav.KonuAnaliz@pdf' +
                             '@' + session.TCKIMLIKNO + '' +
                             '@' + session.OTURUM + '' +
                             '@' + this.DONEM + '' +
                             '@' + JSON.stringify(this.idsinavturu) + '' +
                             '@' + JSON.stringify(this.ID_SINAVS) + '' +
                             '@' + this.idsube + '' +
                             '@' + this.idsinif + '' +
                             '@' + this.tcogrenci + '' +
                             '@' + this.limit + '' +
                             '@' + this.aciklamalimit + '' +
                             '@' + this.aciklama +
                             '@' + 0;

                var xForm = document.createElement("form");
                xForm.target = "rapor";
                xForm.method = "POST"; // or "post" if appropriate
                xForm.action = "../RaporPost.aspx?raportur=pdf";

                var xInput = document.createElement("input");
                xInput.type = "text";
                xInput.name = "p";
                xInput.value = params;
                xForm.appendChild(xInput);

                document.body.appendChild(xForm);

                map = window.open("", "rapor", "");

                if (map) {
                    xForm.submit();
                } else {
                    alert('Açılır sekmelere izin veriniz.');
                }
            },

            Kaydet: function(){
                var params = 'Sinav.KonuAnaliz@pdf' +
                             '@' + session.TCKIMLIKNO + '' +
                             '@' + session.OTURUM + '' +
                             '@' + this.DONEM + '' +
                             '@' + JSON.stringify(this.idsinavturu) + '' +
                             '@' + JSON.stringify(this.ID_SINAVS) + '' +
                             '@' + this.idsube + '' +
                             '@' + this.idsinif + '' +
                             '@' + this.tcogrenci + '' +
                             '@' + this.limit + '' +
                             '@' + this.aciklamalimit + '' +
                             '@' + this.aciklama +
                             '@' + 1;

                var xForm = document.createElement("form");
                xForm.target = "rapor";
                xForm.method = "POST"; // or "post" if appropriate
                xForm.action = "../RaporKonuAnaliz.aspx";

                var xInput = document.createElement("input");
                xInput.type = "text";
                xInput.name = "p";
                xInput.value = params;
                xForm.appendChild(xInput);

                document.body.appendChild(xForm);

                map = window.open("", "rapor", "");

                if (map) {
                    xForm.submit();
                } else {
                    alert('Açılır sekmelere izin veriniz.');
                }
            },

            SubeSelected(item) {
                this.idsube = item;
                this.idkademe3 = 0;
                this.idsinif = 0;
            },

            Kademe3Selected(item) {
                this.idkademe3 = item;
                this.idsinif = 0;
            },

            SinifSelected(item) {
                this.idsinif = item;
                this.tcogrenci = "";
            },

            OgrenciSelected(item) {
                this.tcogrenci = item;
            },

            DonemSelected(item) {
                this.DONEM = item;
            },

            SinavTuruSelected(item) {
                this.idsinavturu = item;
            },

            SinavSelected(item) {
                this.ID_SINAVS = item;
            },
        },
    });
</script>
<script src="Scripts/PublicMethods.js"></script>
