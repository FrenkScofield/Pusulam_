<style>
    td {
        vertical-align: middle !important;
    }

    .row {
        margin-top: 10px !important;
    }

    .TarihSecici {
        cursor: pointer;
        text-align: left;
        width: 100%;
        background: transparent;
        border: none;
        padding-left: 14px;
        padding-right: 14px;
        padding-top: 8px;
        padding-bottom: 7px;
    }

    .modal.right .modal-dialog {
        position: fixed;
        margin: auto;
        width: 990px;
        height: 100%;
        -webkit-transform: translate3d(0%, 0, 0);
        -ms-transform: translate3d(0%, 0, 0);
        -o-transform: translate3d(0%, 0, 0);
        transform: translate3d(0%, 0, 0);
    }

    .modal.right .modal-content {
        height: 100%;
        overflow-y: auto;
    }

    .modal.right .modal-body {
        padding: 15px 15px 15px;
    }

    /*Right*/
    .modal.right.fade .modal-dialog {
        right: -990px;
        -webkit-transition: opacity 0.3s linear, right 0.3s ease-out;
        -moz-transition: opacity 0.3s linear, right 0.3s ease-out;
        -o-transition: opacity 0.3s linear, right 0.3s ease-out;
        transition: opacity 0.3s linear, right 0.3s ease-out;
    }

    .modal.right.fade.in .modal-dialog {
        right: 0;
    }

    /* ----- MODAL STYLE ----- */
    .modal-content {
        border-radius: 0;
        border: none;
    }

    .modal-header {
        border-bottom-color: #EEEEEE;
        background-color: #FAFAFA;
    }
</style>
<div class="page-head">
    <!-- BEGIN PAGE TITLE -->
    <div class="page-title col-md-12">
        <h1>
            Danışman Öğretmen Öğrenci Değerlendirme <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span>
        </h1>
    </div>
    <!-- END PAGE TITLE -->
</div>

<div class="row" id="app">
    <div class="col-md-12">
        <div class="portlet box blue-hoki dd-item" style="border:none">
            <div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filters' style="cursor:pointer;">
                <div class="caption">
                    <i class="icon-list"></i>
                    <span class="caption-subject bold uppercase"> Filtreler </span>
                    <span class="caption-helper"></span>
                </div>
                <div class='actions'>
                    <a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
                        <i class='fa fa-chevron-down'></i>
                    </a>
                </div>
            </div>
            <!-- BEGIN PORTLET-->
            <div class="portlet-body form collapse in" id="filters">
                <form role="form" style="padding:12px 20px">
                    <div class="row">
                        <c-danisman-ogretmen-sinif controller="ProjeDonem"
                                                   :idsinif="ID_SINIF"
                                                   @OnChange="SinifSelected">
                        </c-danisman-ogretmen-sinif>
                    </div>
                    <div class="row">
                        <c-listelemetipi @OnChange="ListelemeTipiSelected" />
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-12" v-if="ID_SINIF != null && ID_SINIF != 0 && LISTE.length > 0">
        <div class="portlet light">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-list font-green"></i>
                    <span class="caption-subject bold font-green uppercase"> Soru Listesi </span>
                    <span class="caption-helper"></span>
                </div>
            </div>
            <div class="portlet-body form">
                <form role="form">
                    <div class="portlet light bordered">
                        <div class="portlet-body" style="overflow-x:auto;">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>ÖĞRENCİ</th>
                                        <th>YORUM</th>
                                        <th style="width:82px;">İŞLEM</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="u in LISTE">
                                        <td>{{u.ADSOYAD}}</td>
                                        <td><textarea v-model="u.YORUM" class="form-control" rows="3" style="resize:vertical;" placeholder="Öğrenci ile ilgili genel değerlendirmenizi yazınız..." /></td>
                                        <td>
                                            <a style='width:100px;' @click='Kaydet(u.TCKIMLIKNO, u.YORUM, u.ID_DEGERLENDIRMEYORUM, u.ID_DEGERLENDIRMEPERIYOT)' class='btn btn-sm yellow'> KAYDET <i class='fa fa-pencil'></i></a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="../../VueComponents/SinavFiltreleri.js"></script>
<script src="../../VueComponents/YetkilendirmeFiltreleri.js"></script>
<script src="../../VueComponents/Degerlendirme/Filtreler.js?v=1"></script>

<script>
    var vue = new Vue({

        el: "#app",
        name: "DegerlendirmeDanismanOgrenci.html",

        data: {
            ID_KULLANICITIPI: 4,
            ID_SINIF: 0,
            ID_LISTELEMETIPI: 0,
            LISTE: []
        },

        mounted() {
        },

        methods: {
            SinifSelected(ID_SINIF) {
                this.ID_SINIF = ID_SINIF;
                this.Listele();
            },

            ListelemeTipiSelected(ID_LISTELEMETIPI) {
                this.ID_LISTELEMETIPI = ID_LISTELEMETIPI;
                this.Listele();
            },

            Listele() {
                if (this.ID_SINIF != 0) {
                    var p = {
                        TCKIMLIKNO: session.TCKIMLIKNO,
                        OTURUM: session.OTURUM,
                        ID_SINIF: this.ID_SINIF,
                        ID_KULLANICITIPI: this.ID_KULLANICITIPI,
                        ID_LISTELEMETIPI: this.ID_LISTELEMETIPI,
                        YORUMTUR: 2
                    };

                    WebPost(this, "DegerlendirmeDanismanOgrenci", "SinifYorumListele", p, '', '', function (data, parent) {
                        if (data != null && data.length > 0) {
                            vue.LISTE = JSON.parse(data);
                            $('#filters').collapse();
                        }
                        else {
                            vue.LISTE = [];
                        }
                    });
                } else {
                    vue.LISTE = [];
                }                
            },

            Kaydet(TCKIMLIKNO, YORUM, ID_DEGERLENDIRMEYORUM, ID_DEGERLENDIRMEPERIYOT) {
                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    TCPERSONEL: TCKIMLIKNO,
                    YORUM: YORUM,
                    ID_DEGERLENDIRMEYORUM: ID_DEGERLENDIRMEYORUM,
                    ID_DEGERLENDIRMEPERIYOT: ID_DEGERLENDIRMEPERIYOT,
                    YORUMTUR: 2
                };

                WebPost(this, "DegerlendirmeDanismanOgrenci", "Kaydet", p, '', '', function (data, parent) {
                    vue.Listele();
                });
            },
        }
    });
</script>
<script src="Scripts/PublicMethods.js"></script>
