<link href="assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css" rel="stylesheet" type="text/css" />
<style>
    td {
        vertical-align: middle !important;
    }

    .row {
        margin-top: 10px !important;
    }
</style>
<div class="page-head">
    <!-- BEGIN PAGE TITLE -->
    <div class="page-title col-md-12">
        <h1>
            Progress Check Sınav Listesi <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span>
        </h1>
    </div>
    <!-- END PAGE TITLE -->
</div>

<div class="row" id="app">
    <div class="col-md-12">
        <div class="portlet box blue-hoki dd-item" style="border:none">
            <div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filters' style="cursor:pointer;">
                <div class="caption">
                    <i class="icon-magnifier"></i>
                    <span class="caption-subject bold uppercase"> Filtreler </span>
                    <span class="caption-helper"></span>
                </div>
                <div class='actions'>
                    <a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
                        <i class='fa fa-chevron-down'></i>
                    </a>
                </div>
            </div>
            <!-- BEGIN PORTLET-->
            <div class="portlet-body form collapse in" id="filters">
                <form role="form" style="padding:12px 20px">
                    <div class="row">
                        <c-donem controller="SinavListele"
                                 @OnChange="DonemSelected">
                        </c-donem>
                    </div>
                    <div class="row">
                        <c-sinavgrup controller="SinavListele"
                                     :id_kademe3="ID_KADEME3"
                                     @OnChange="SinavGrupSelected">
                        </c-sinavgrup>
                    </div>

                    <div class="row">
                        <label class="control-label col-md-3" style="vertical-align:middle;">Pasif Sınavlar Görünsün</label>
                        <div class="col-md-9" style="height:34px; vertical-align:middle;">
                            <div class="md-checkbox" style="margin:auto!important; width:20px!important; height:20px; margin:0px; margin-top:6px; display:block;">
                                <input type="checkbox" v-model="pasifGorunsun" id="pasifGorunsun" class="md-check" v-bind:true-value="true" v-bind:false-value="false" />
                                <label for="pasifGorunsun">
                                    <span></span>
                                    <span class="check"></span>
                                    <span class="box"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group" style="margin-top:10px;">
                            <div class="col-md-12 text-right">
                                <button type="button" class="btn green" @click="SinavListele">Sınav Listele</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-12" v-if="SINAVLISTESI.length>0">
        <div class="portlet light">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-list font-green"></i>
                    <span class="caption-subject bold font-green uppercase"> Sınav Listesi </span>
                    <span class="caption-helper"></span>
                </div>
            </div>
            <!-- BEGIN PORTLET-->
            <div class="portlet-body form">
                <form role="form">
                    <div class="portlet light bordered">
                        <div class="portlet-body">
                            <table class="table table-striped table-bordered table-hover table-checkable" id="sinavtable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>SINAV ADI</th>
                                        <th>DÖNEM</th>
                                        <th>SINAV GRUBU</th>
                                        <th>KAYDEDEN <br />KULLANICI</th>
                                        <th>KAYIT TARİHİ</th>
                                        <th>AKTİF </th>
                                        <th>İŞLEM</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="odd gradeX" v-for="u in SINAVLISTESI">
                                        <td>{{u.ID_ASSESSMENT}}</td>
                                        <td>{{u.AD}}</td>
                                        <td>{{u.DONEM}}</td>
                                        <td>{{u.KADEME3}}</td>
                                        <td>{{u.ADSOYAD}}</td>
                                        <td>{{u.KYE_TARIH}}</td>
                                        <td>
                                            <div class="col-md-9" style="height:34px; vertical-align:middle;">
                                                <div class="md-checkbox" style="margin:auto!important; width:20px!important; height:20px; margin:0px; margin-top:6px; display:block;">
                                                    <input type="checkbox" v-model="u.AKTIF" :id="u.ID_ASSESSMENT+'AKTIF'" class="md-check" v-bind:true-value="true" v-bind:false-value="false" @click="AktifPasifDegistir(u)" />
                                                    <label :for="u.ID_ASSESSMENT+'AKTIF'">
                                                        <span></span>
                                                        <span class="check"></span>
                                                        <span class="box"></span>
                                                    </label>
                                                </div>
                                            </div>
                                        </td>
                                        <td><button type="button" class="btn green" @click="Duzenle(u.ID_ASSESSMENT)">Düzenle</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </form>
            </div>
            <!-- END PORTLET-->
        </div>
    </div>
</div>
<script src="VueComponents/SinavFiltreleri.js?v=5"></script>

<script>
    var vue = new Vue({

        el: "#app",
        name: "SinavListele.html",

        data: {
            DONEM: '',
            ID_KADEME3: 0,
            SINAVLISTESI: [],
            pasifGorunsun: false,
        },

        mounted() {

        },

        methods: {

            DonemSelected(DONEM) {
                this.DONEM = DONEM;
            },
            SinavGrupSelected(ID_KADEME3) {
                this.ID_KADEME3 = ID_KADEME3;
            },

            SinavListele() {
                var _this = this;

                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    DONEM: this.DONEM,
                    ID_KADEME3: this.ID_KADEME3,
                    PASIFGORUNSUN: this.pasifGorunsun,
                };

                WebPost(this, "AssessmentSinavListele", "SinavListele", p, '#sinavtable', 'Yükleniyor..', function (data, parent) {

                    _this.SINAVLISTESI = JSON.parse(data);

                    if (_this.SINAVLISTESI.length == 0) {
                        Alert_Warning("Liste Bulunamadı!");
                    }
                    else {
                        $('#filters').collapse();
                    }
                });
            },
            Duzenle(id) {
                window.location.replace('/anasayfa.html#Assessment/SinavTanimla?ID_ASSESSMENT=' + id);
            },

            AktifPasifDegistir(item) {
                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    ID_ASSESSMENT: item.ID_ASSESSMENT,
                    AKTIF: item.AKTIF,
                };

                WebPost(this, "AssessmentSinavListele", "AktifPasifDegistir", p, '#sinavtable', 'Yükleniyor..', function (data, parent) {
                    if (data != null || data != undefined) {
                        if (data == 1) {
                            item.AKTIF
                                ? Alert_Info("Sınav Aktif Olarak Düzenlendi")
                                : Alert_Warning("Sınav Pasif Olarak Düzenlendi");
                        }
                        else {
                            Alert_Error("Sınavın Özelliği Düzenlenemedi");
                        }
                    }
                    else {
                        Alert_Warning("Liste Bulunamadı!");
                    }
                });
            },


        }
    });
</script>
<script src="Scripts/PublicMethods.js"></script>
<script src="assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js" type="text/javascript"></script>
