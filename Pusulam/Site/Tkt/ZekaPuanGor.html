<style>
    table.dataTable td.sorting_1, table.dataTable td.sorting_2, table.dataTable td.sorting_3,
    table.dataTable th.sorting_1,
    table.dataTable th.sorting_2,
    table.dataTable th.sorting_3 {
        background-color: #78C1DD !important;
    }

    #ogrencisonuc_wrapper {
        overflow: scroll;
        overflow-y: hidden;
    }

    .dt-buttons {
        margin: 0px !important;
        float: left !important;
    }
</style>
<div class="page-head">
    <div class="page-title col-md-12">
        <h1>
            Öğrenci Listesi <small>TKT Zeka Puanı Gör</small> <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span>
        </h1>
    </div>
</div>

<div class="row" id="app">
    <!--<div class="col-md-12" v-if="TCKIMLIKNO != '56545519606'">Sayfa güncelleniyor. Daha sonra tekrar deneyiniz.</div>
    <div v-else>-->
    <div>
        <div class="col-md-12">
            <div class="portlet box green-haze dd-item" style="border:none">
                <div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filters' style="cursor:pointer;">
                    <div class="caption">
                        <i class="icon-magnifier"></i>
                        <span class="caption-subject bold uppercase"> Filtreler </span>
                        <span class="caption-helper"></span>
                    </div>
                    <div class='actions'>
                        <a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
                            <i class='fa fa-chevron-down'></i>
                        </a>
                    </div>
                </div>
                <div class="portlet-body form collapse in" id="filters">

                    <div class="form-body form-horizontal">

                        <div class="row">
                            <c-sube-multi controller="ZekaPuanGor"
                                          @OnChange="SubeSelected">
                            </c-sube-multi>
                        </div>
                        <div class="row">
                            <c-sinavgrup-multi-bcyok controller="TopluSonucGor"
                                                     :idsube="ID_SUBE"
                                                     @OnChange="SinavGrupSelected">
                            </c-sinavgrup-multi-bcyok>
                        </div>
                        <div class="row">
                            <c-donem controller="ZekaPuanGor"
                                     @OnChange="DonemSelected">
                            </c-donem>
                        </div>
                        <div class="row">
                            <c-sinif-multi-id_subes-donem controller="ZekaPuanGor"
                                                          :idsube="ID_SUBE"
                                                          :idsinavgrup="ID_SINAVGRUP"
                                                          :donem="DONEM"
                                                          @OnChange="SinifSelected">
                            </c-sinif-multi-id_subes-donem>
                        </div>
                        <div class="row">
                            <c-zeka-turu-multi controller="ZekaPuanGor"
                                               @OnChange="ZekaTurSelected">
                            </c-zeka-turu-multi>
                        </div>
                        <div class="row">
                            <c-tarih controller="ZekaPuanGor"
                                     @change-date="TarihSelected">
                            </c-tarih>
                        </div>
                        <div class="row">
                            <div class="col-md-3 text-right" style="line-height:84px;">
                                Hesap Türü
                            </div>
                            <div class="col-md-9">
                                <div class="form-group form-md-radios">
                                    <div class="md-radio-list col-md-12">
                                        <div class="md-radio">
                                            <input type="radio" id="SECILEN" name="SECILEN" class="md-radiobtn" value="1" v-model="HANGITARIH">
                                            <label for="SECILEN">
                                                <span class="inc"></span>
                                                <span class="check"></span>
                                                <span class="box"></span> SEÇİLEN TARİHE GÖRE
                                            </label>
                                        </div>
                                        <div class="md-radio" style="margin:0px;">
                                            <input type="radio" id="GIRILEN" name="GIRILEN" class="md-radiobtn" value="0" v-model="HANGITARIH">
                                            <label for="GIRILEN">
                                                <span></span>
                                                <span class="check"></span>
                                                <span class="box"></span> CEVAP GİRİŞ TARİHİNE GÖRE
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 text-right" style="line-height:20px;">
                                Puan Hesaplanmayanları Gör
                            </div>
                            <div class="col-md-9">
                                <div class="md-checkbox" style="margin:auto!important; height:20px; margin:0px; display:block;">
                                    <input type="checkbox" id="chkPuansiz" class="md-check" value="0" />
                                    <label for="chkPuansiz">
                                        <span></span>
                                        <span class="check"></span>
                                        <span class="box"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="col-md-12 text-right" style="margin-left:0px;margin-right:0px;">
                                <button type="button" class="btn green" @click="Listele">Listele</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-12" v-show="LISTE.length>0">
            <div class="portlet light">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-list font-green"></i>
                        <span class="caption-subject bold font-green uppercase"> Öğrenci Test Sonucu </span>
                        <span class="caption-helper"></span>
                    </div>
                </div>
                <div class="portlet-body form">
                    <form role="form">
                        <div class="portlet light bordered">
                            <div class="portlet-body">
                                <table id="ogrencisonuc" class="table table-striped table-bordered table-checkable">
                                    <thead>
                                        <tr>
                                            <th>TC Kimlik No</th>
                                            <th>Ad Soyad</th>
                                            <th>Kampüs</th>
                                            <th>Sınıf</th>
                                            <th>Şube</th>
                                            <th>Ön Test Zeka Puanı</th>
                                            <th>Ön Test Zeka Kategorisi</th>
                                            <th>Ara Test Zeka Puanı</th>
                                            <th>Ara Test Zeka Kategorisi</th>
                                            <th>Son Test Zeka Puanı</th>
                                            <th>Son Test Zeka Kategorisi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbody"></tbody>
                                </table>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="VueComponents/SoruFiltreleri.js?v=3"></script>
<script src="VueComponents/SubeGrupSinif.js?v=3"></script>
<script src="VueComponents/ZekaFiltreleri.js?v=3"></script>

<script>
    var vue = new Vue({
        el: "#app",
        name: "ZekaPuanGor.html",

        data: {
            TCKIMLIKNO: '',
            DONEM: '',
            ID_SUBE: [],
            ID_SINAVGRUP: [],
            ID_SINIF: [],
            ID_TKTZEKATURU: [],
            LISTE: [],
            TARIH: '',
            HANGITARIH: 1
        },

        mounted() {
            this.TCKIMLIKNO = session.TCKIMLIKNO;
        },

        methods: {
            TarihSelected(TARIH) {
                this.TARIH = TARIH;
            },

            DonemSelected(DONEM) {
                this.DONEM = DONEM;
            },

            SubeSelected(ID_SUBE) {
                this.ID_SUBE = ID_SUBE;
            },

            SinavGrupSelected(item) {
                this.ID_SINAVGRUP = item;
            },

            SinifSelected(ID_SINIF) {
                this.ID_SINIF = ID_SINIF;
            },

            ZekaTurSelected(ID_TKTZEKATURU) {
                this.ID_TKTZEKATURU = ID_TKTZEKATURU;
            },

            Listele() {
                var _idsinavgrup = this.ID_SINAVGRUP;
                var _idsinif = '';
                $.each(this.ID_SINIF, function (i) {
                    _idsinif += this + ',';
                });
                var _idzekaturu = '';
                $.each(this.ID_TKTZEKATURU, function (i) {
                    _idzekaturu += this + ',';
                });
                var Puansiz = ($("#chkPuansiz").is(':checked'));
                this.LISTE = [];
                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    ID_SINIFS: _idsinif,
                    ID_TKTZEKATURUS: _idzekaturu,
                    PUANSIZ: Puansiz,
                    DONEM: this.DONEM,
                    TARIH: this.TARIH,
                    HESAPTURU: this.HANGITARIH
                };

                $("#ogrencisonuc").DataTable().destroy();
                $("#tbody").html("");
                WebPost(this, "ZekaPuanGor", "TKTZekaTuruOgrenciListele", p, '', '', function (data, parent) {
                    if (data != null) {
                        $('#filters').collapse('hide');
                        var html = '';
                        parent.LISTE = JSON.parse(data)[0].t1;
                        $.each(JSON.parse(data)[0].t1, function (j, el) {
                            html += '<tr>';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.TCKIMLIKNO + '</td>        ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.ADSOYAD + '</td>           ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.SUBEAD + '</td>            ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.SINIF + '</td>             ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.SINIFAD + '</td>           ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.ONZEKAPUANI + '</td>       ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.ONZEKAKATEGORI + '</td>    ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.ARAZEKAPUANI + '</td>      ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.ARAZEKAKATEGORI + '</td>   ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.SONZEKAPUANI + '</td>      ';
                            html += '<td style="background-color:#32c5d2; color:#fff; font-weight:600;">' + el.SONZEKAKATEGORI + '</td>   ';
                            html += '</tr>';
                        });
                        $("#tbody").html(html);
                        $("#ogrencisonuc").DataTable().destroy();
                        Vue.nextTick(function () {
                            $('#ogrencisonuc').DataTable(
                                {
                                    "order": [[2, 'asc'], [3, 'asc'], [4, 'asc']],
                                    language: { "url": "./Utility/dil.json" },
                                    dom: 'Bfrtip',
                                    buttons: [
                                        { extend: 'pageLength', text: 'Gösterilecek Öğrenci Sayısı' }, 'excel', { extend: 'print', text: 'Yazdır' }
                                    ]
                                });
                        })
                    }
                    else {
                        Alert_Warning("Seçilen kriterlere göre öğrenci bulunamadı!");
                    }
                })
            },
        }
    });
</script>
<script src="Scripts/PublicMethods.js"></script>