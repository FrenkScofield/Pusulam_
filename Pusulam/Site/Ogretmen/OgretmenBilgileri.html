
<div class="page-head">
    <div class="page-title col-md-12">
        <h1>
            Öğretmen Bilgileri Raporu  <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span>
        </h1>
    </div>

</div>

<div class="row" id="app">
    <div class="col-md-12">
        <div class="portlet box green-haze dd-item" style="border:none; margin-bottom:0px!important;">
            <div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filters' style="cursor:pointer;">
                <div class="caption">
                    <i class="icon-magnifier"></i>
                    <span class="caption-subject bold uppercase"> Filtreler </span>
                    <span class="caption-helper"></span>
                </div>
                <div class='actions'>
                    <a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
                        <i class='fa fa-chevron-down'></i>
                    </a>
                </div>
            </div>
            <div class="portlet-body form collapse in" id="filters">

                <div class="portlet light col-md-12" style="margin:0px; border-bottom-style: solid;border-bottom-width: 3px;border-bottom-color: rgb(0, 173, 239);">
                    <div class="portlet-body">
                        <div class="form-inline">
                            <div class="row">
                                <div class="col-md-12 row">
                                    <c-sube-multi :controller="controller"
                                                  @OnChange="SubeSelected">
                                    </c-sube-multi>
                                </div>

                                <div class="col-md-12 row">
                                    <c-ogretmen-multi :controller="controller"
                                                      :idsubelist="ID_SUBELIST"
                                                      @onchange="OgretmenSelected">
                                    </c-ogretmen-multi>
                                </div>


                                <div class="col-md-12 row">
                                    <div class="form-md-line-input">
                                        <div class="col-md-3"></div>
                                        <div class="col-md-9">
                                            <button type="button" class="btn yellow" @click="Listele">Listele</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 row">
                                    <div class="col-md-3">Rapor</div>
                                    <div class="col-md-9" style=" margin-left: -20px;">
                                        <c-rapor-tur-buton colmd="3" @Yazdir="Yazdir"> </c-rapor-tur-buton>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-12" v-if="LISTE.length>0">
        <div class="portlet light">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-list font-green"></i>
                    <span class="caption-subject bold font-green uppercase">Öğretmen Listesi </span>
                    <span class="caption-helper"></span>
                </div>
            </div>

            <div class="portlet-body form">
                <form role="form">
                    <div class="portlet light bordered">
                        <div class="portlet-body">
                            <div>
                                <table class="table table-striped table-bordered table-hover table-checkable" id="tblName">
                                <thead>
                                    <tr>
                                        <th>AD SOYAD</th>
                                        <th>TCKIMLIKNO</th>
                                        <th>SUBE</th>
                                        <th>KADEME</th>
                                        <th>SINIF</th>
                                        <th>DERS</th>
                                        <th>TOPLAM DERS SAATİ</th>
                                        <th>E-POSTA</th>
                                        <th>TELEFON</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="odd gradeX" v-for="u in LISTE">
                                        <td>{{u['AD SOYAD']}} </td>
                                        <td>{{u['TC KİMLİK NO']}} </td>
                                        <td>
                                            <div v-html="u.SUBE">
                                            </div>
                                        </td>
                                        <td>
                                            <div v-html="u.KADEME">
                                            </div>
                                        </td>
                                        <td>
                                            <div v-html="u.SINIF">
                                            </div>
                                        </td>
                                        <td>
                                            <div v-html="u.DERS">
                                            </div>
                                        </td>
                                        <td>{{u['TOPLAM DERS SAATİ']}} </td>
                                        <td>{{u.EMAIL}}</td>
                                        <td>{{u.TELEFON}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="/VueComponents/Genel.js?v=3"></script>
<script src="../../VueComponents/Filtre.js?v=001"></script>
<script src="../../VueComponents/FiltreEk.js?v=001"></script>
<script>
    var vue = new Vue({
        el: "#app",
        name: "OgretmenBilgileri.html",

        data: {
            controller: 'OgretmenBilgileri',
            TCKIMLIKNO: session.TCKIMLIKNO,
            OTURUM: session.OTURUM,

            LISTE: [],
            ID_SUBELIST: [],
            TCOGRETMENLIST: [],
        },

        methods: {
            SubeSelected(val) {
                this.ID_SUBELIST = val;
                ListeTemizle(this.TCOGRETMENLIST);
            },
            OgretmenSelected(val) {
                this.TCOGRETMENLIST = val;
            },

            Listele() {
                ListeTemizle(this.LISTE)

                let p = {
                    TCKIMLIKNO: this.TCKIMLIKNO,
                    OTURUM: this.OTURUM,
                    TCOGRETMENLIST: JSON.stringify(this.TCOGRETMENLIST)
                };

                WebPost(this, this.controller, "OgretmenBilgileriListele", p, '', '', function (data, parent) {
                    if (data != '[]') {
                        parent.LISTE = JSON.parse(data);                        
                        ListeOlustur("tblName");
                    }
                    else {
                        Alert_Warning("Öğretmen Listesi Bulunamadı");
                    }
                });
            },

            Yazdir(ciktiTuru) {
                if (ciktiTuru == "") {
                    Alert_Warning("Çıktı Türünü Seçiniz.");
                    return;
                }

                if ( this.TCOGRETMENLIST.length == 0) {
                    Alert_Warning("Öğretmen Seçimini yapmanız gerekmektedir.");
                }
                else {


                    var params = 'Ogretmen.OgretmenBilgileri' +
                        '@' + ciktiTuru +
                        '@' + session.TCKIMLIKNO +
                        '@' + session.OTURUM +
                        '@' + JSON.stringify(this.TCOGRETMENLIST);

                    var xForm = document.createElement("form");
                    xForm.target = "rapor";
                    xForm.method = "POST";
                    xForm.action = "../RaporPost.aspx";

                    var xInput = document.createElement("input");
                    xInput.type = "text";
                    xInput.name = "p";
                    xInput.value = params;
                    xForm.appendChild(xInput);
                    xForm.hidden = "hidden";
                    document.body.appendChild(xForm);

                    map = window.open("", "rapor", "");

                    if (map) {
                        xForm.submit();
                    } else {
                        Alert_Error('Açılır sekmelere izin veriniz.');
                    }


                    //window.open('../Rapor.aspx?rapor=SinifListesi.SinifListeRaporu&raporTur=' + ciktiTuru + '&p='
                    //    + this.TCKIMLIKNO + ';'
                    //    + this.OTURUM + ';'
                    //    + (this.SINIFLAR.indexOf(0) > -1 ? '[0]' : JSON.stringify(this.SINIFLAR)) + ';'
                    //    + JSON.stringify(this.ID_SUBELIST) + ';0'
                    //    , '_blank');
                }
            },
        },
    });
</script>
<script src="Scripts/PublicMethods.js"></script>
