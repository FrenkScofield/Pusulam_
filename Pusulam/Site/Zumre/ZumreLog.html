
<div class="page-head">
    <div class="page-title col-md-12">
        <h1>
            Zümre <small>Log</small>
            <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span>
        </h1>
    </div>
</div>
<div class="row" id="app">
    <div class="row" id="app" style="margin-top:0px!important;">
        <div class="col-md-12">
            <div class="portlet light panel-heading">

                <!--<div class="col-md-12 ">

                    <c-sinavgrup controller="Bilgiler"
                                 @OnChange="SinifSelected">
                    </c-sinavgrup>
                </div>-->
                <div class="row form-group">
                    <label class="control-label col-md-3">
                        Başlangıç Tarihi
                    </label>
                    <div class="col-md-9">
                        <input type="text" id="dpBasTarih" data-date-format="dd-mm-yyyy" placeholder="Başlangıç Tarihi" class="form-control form-control-inline date-picker">
                    </div>
                </div>
                <div class="row form-group">
                    <label class="control-label col-md-3">
                        Bitiş Tarihi
                    </label>
                    <div class="col-md-9">
                        <input type="text" id="dpBitTarih" data-date-format="dd-mm-yyyy" placeholder="Bitiş Tarihi" class="form-control form-control-inline date-picker">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group" style="margin-top:10px;">
                        <div class="col-md-12 text-right">
                            <button type="button" class="btn blue" @click="Listele">Listele</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="portlet light panel-body" v-show="LOGLIST.length >0">
                <div class="col-md-12 row">
                    <div class="row">
                        <table class="table table-striped table-bordered table-checkable" id='loglist'>
                            <thead>
                                <tr>
                                    <th>TCKIMLIKNO</th>
                                    <th>AD</th>
                                    <th>Haftanın Kazanımı</th>
                                    <th>Kazanım Analiz Etkinlik</th>
                                    <th>Öğretim Yöntem Tekniği</th>
                                    <th>Kaynak Kitap Sayfa Aralığı</th>
                                    <th>Haftanın Atasözü ve Deyimi</th>
                                    <th>Okuma Kitabı</th>
                                    <th>Değerler Bilinci</th>
                                    <th>Haftanın Araştırması</th>
                                    <th>Belirli Gün ve Haftalar</th>
                                    <th>Haftanın Ödevi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="odd gradeX" v-for="u in LOGLIST">
                                    <td>{{u.TCKIMLIKNO}}</td>
                                    <td>{{u.AD}}</td>
                                    <td>{{u.HAFTANIN_KAZANIMI}}</td>
                                    <td>{{u.KAZANIM_ANALIZ}}</td>
                                    <td>{{u.OGRETIM_YONTEM}}</td>
                                    <td>{{u.KAYNAK_KITAP}}</td>
                                    <td>{{u.HAFTANIN_ATASOZU}}</td>
                                    <td>{{u.OKUMA_KITABI}}</td>
                                    <td>{{u.DERGERLER_BILINCI}}</td>
                                    <td>{{u.HAFTANIN_ARASTIRMASI}}</td>
                                    <td>{{u.BELIRLI_GUN}}</td>
                                    <td>{{u.HAFTANIN_ODEVI}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/Scripts/Tools.js"></script>

<script>
    var loglist = null;
    var vue = new Vue({
        el: "#app",
        name: "ZumreLog.html",

        data: {
            TCKIMLIKNO: '',
            OTURUM: '',
            controller: 'Bilgiler',
            DONEM: '',
           
            LOGLIST:[]
        },

        mounted() {



            $('#dpBasTarih').datepicker({
                format: 'dd.mm.yyyy',
                language: 'tr',
                beforeShowDay: function (d) {
                    let day = d.getDay();
                    if (day != 1) {
                        return false
                    }

                    return true;
                },
            }).change(function (d) {
                let val = $('#dpBasTarih').val();
                var valArr = val.split('.')

                let day = valArr[0];
                let month = valArr[1];
                let year = valArr[2];

                let dt = new Date(year, month - 1, day);
                let lastdt = new Date(dt.setDate(dt.getDate() - dt.getDay() + 5));

                let lastday = lastdt.getDate();
                lastday = lastday.toString().length == 1 ? '0' + lastday.toString() : lastday.toString();
                let lastmonth = lastdt.getMonth() + 1;
                lastmonth = lastmonth.toString().length == 1 ? '0' + lastmonth.toString() : lastmonth.toString();
                let lastyear = lastdt.getFullYear();

                $("#dpBitTarih").val(lastday + '.' + lastmonth + '.' + lastyear);
            });




            var curr = new Date;
            var firstday = new Date(curr.setDate(curr.getDate() - curr.getDay() + 1));
            $("#dpBasTarih").datepicker("setDate", firstday);




            //$('#dpBasTarih').datepicker({
            //    format: 'dd.mm.yyyy',
            //    language: 'tr',

            //});

            //$('#dpBitTarih').datepicker({
            //    format: 'dd.mm.yyyy',
            //    language: 'tr'
            //});

            //var curr = new Date;
            //var firstday = new Date(curr.setDate(curr.getDate() - curr.getDay() + 1));
            //var lastday = new Date(curr.setDate(curr.getDate() - curr.getDay() + 5));

            //$("#dpBasTarih").datepicker("setDate", firstday);
            //$("#dpBitTarih").datepicker("setDate", lastday);



        },

        methods: {


            Listele() {
                var basTarih = $("#dpBasTarih").val();
                var bitTarih = $("#dpBitTarih").val();
                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    ID_DERS: this.ID_DERS,
                    ID_KADEME3: this.ID_KADEME3,
                    BAS_TARIH: basTarih,
                    BIT_TARIH: bitTarih
                }

                WebPost(this, this.controller, "LogListele", p, '', '', function (data, parent) {
                    if (JSON.parse(data)) {
                        parent.LOGLIST = JSON.parse(data);
                        //parent.KAZANIM.KAZANIM_ANALIZ = parent.JSONUNITE[0].KAZANIM[0].ICERIK;
                        //DOM update olmasını bekleyip update olunca listeyi oluşturuyor.
                        Vue.nextTick(function () {
                            parent.ListeOlustur();
                        })
                    }
                });
            },

            ListeOlustur() {
                if (loglist) {
                    loglist.destroy();
                }
                loglist = $('#loglist').DataTable(
                    {
                        "columnDefs": [{ "width": "25%", "targets": 0 }],
                        language: {
                            "url": "./Utility/dil.json"
                        }
                    });
            },


        },


    });
</script>
<script src="Scripts/PublicMethods.js"></script>
<script src="assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js" type="text/javascript"></script>
