 
<link href="assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<div class="page-head">
    <div class="page-title col-md-12">
        <h1> Sınav Listesi <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span> </h1>
    </div>
</div>

<div class="row" id="app">
    <div class="col-md-12">
        <div class="portlet box blue-hoki dd-item" style="border:none">
            <div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filters' style="cursor:pointer;">
                <div class="caption">
                    <i class="icon-magnifier"></i>
                    <span class="caption-subject bold uppercase"> Filtreler </span>
                    <span class="caption-helper"></span>
                </div>
                <div class='actions'>
                    <a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
                        <i class='fa fa-chevron-down'></i>
                    </a>
                </div>
            </div>
            <div class="portlet-body form collapse in" id="filters">
                <form role="form" style="padding:12px 20px">
                    <div class="row">
                        <c-donem :controller="controller"
                                 @OnChange="DonemSelected">
                        </c-donem>
                    </div>
                    <div class="row">
                        <c-kademe3 :controller="controller"
                                   @OnChange="SinavGrupSelected">
                        </c-kademe3>
                    </div>
                    <div class="row">
                        <c-sinav-turu :controller="controller"
                                      :idkademe3="ID_KADEME3"
                                      :sinavdurum=true
                                      :idset="ID_SINAVTURU"
                                      @OnChange="SinavTuruSelected">
                        </c-sinav-turu>
                    </div>
                    <div class="row">
                        <c-sinav :controller="controller"
                                 :idkademe3="ID_KADEME3"
                                 :idsinavturu="ID_SINAVTURU"
                                 :donem="DONEM"
                                 :onlinesinav=true
                                 :idset="ID_SINAV"
                                 @OnChange="SinavSelected">
                        </c-sinav>
                    </div>

                    <div class="row">
                        <div class="form-group" style="margin-top:10px;">
                            <div class="col-md-12 text-right">
                                <button type="button" class="btn green" @click="OnlineSinavDetay">Detay</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-12" v-if="SINAVDETAY != undefined">
        <div class="portlet light">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-list font-green"></i>
                    <span class="caption-subject bold font-green uppercase"> Sınav Detay </span>
                    <span class="caption-helper"></span>
                </div>
            </div>
            <div class="portlet-body form">
                <form role="form">
                    <div class="portlet light bordered">
                        <div class="row">
                            <div v-for="(u,i) in SINAVDETAY.OSDO" class="col-md-12">
                                <div class="form-group">
                                    <label>
                                        {{u.OTURUM}}. OTURUM
                                    </label>
                                </div>

                                <div class="form-group">

                                    <div class="col-md-6" >
                                        <c-tarih-turkish :tarihid="'basTarih'+u.OTURUM"
                                                         label="Baş.Tarihi"
                                                         :idset="TARIH[i].BASTARIH"
                                                         v-model="u.BASTARIH">
                                        </c-tarih-turkish>
                                    </div>
                                    <div class="col-md-6">
                                        <c-saat :id="'basSaat'+u.OTURUM"
                                                label="Baş.Saat"
                                                :idset="TARIH[i].BASSAAT"
                                                v-model="u.BASSAAT">
                                        </c-saat>
                                    </div>
                                </div>
                                <div class="form-group" style="padding-top:35px">
                                    <div class="col-md-6">
                                        <c-tarih-turkish :tarihid="'bitTarih'+u.OTURUM"
                                                         label="Bit.Tarihi"
                                                         :idset="TARIH[i].BITTARIH"
                                                         v-model="u.BITTARIH">
                                        </c-tarih-turkish>
                                    </div>
                                    <div class="col-md-6">
                                        <c-saat :id="'bitSaat'+u.OTURUM"
                                                label="Bit.Saat"
                                                :idset="TARIH[i].BITSAAT"
                                                v-model="u.BITSAAT">
                                        </c-saat>
                                    </div>
                                </div>

                                <div class="col-md-6 form-group" style="padding-top:25px" v-if="!ONLINETEST">
                                    <div class="form-md-line-input">
                                        <label class="control-label col-md-3">Oturum Süresi <small>(dk)</small></label>
                                        <div class="col-md-9">
                                            <input type="number" v-model="u.SURE" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                <hr />

                            </div>


                            <div class="form-group" style="padding-top:35px" v-if="!ONLINETEST">
                                <div class="col-md-6">
                                    <c-tarih-turkish tarihid="ackTarih"
                                                     label="Başlangıç Açıklanma Tarihi"
                                                     :idset="ACIKLANMATARIH"
                                                     v-model="SINAVDETAY.ACIKLANMATARIH">
                                    </c-tarih-turkish>
                                </div>
                                <div class="col-md-6">
                                    <c-tarih-turkish tarihid="btsTarih"
                                                     label="Bitiş Açıklanma Tarihi"
                                                     :idset="BITACIKLANMATARIH"
                                                     v-model="SINAVDETAY.BITACIKLANMATARIH">
                                    </c-tarih-turkish>
                                </div>
                                <div class="col-md-6">
                                    <c-saat id="ackSaat"
                                            label="Açıklanma Saat"
                                            :idset="ACIKLANMASAAT"
                                            v-model="SINAVDETAY.ACIKLANMASAAT">
                                    </c-saat>
                                </div>
                            </div>
                           
                            <!--<div class="form-group" style="padding-top:35px">
                                <div class="form-md-line-input">
                                    <label class="control-label col-md-3">Sınav Sonunda Cevapları Gör</label>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <div class="col-md-9" style="height:34px; vertical-align:middle;">
                                                <div class="md-checkbox" style="margin:auto!important; width:20px!important; height:20px; margin:0px; margin-top:6px; display:block;">
                                                    <input type="checkbox" v-model="SINAVDETAY.CEVAPGOR" id="chkCEVAPGOR" class="md-check" v-bind:true-value="true" v-bind:false-value="false" />
                                                    <label for="chkCEVAPGOR">
                                                        <span></span>
                                                        <span class="check"></span>
                                                        <span class="box"></span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>-->


                            <div class="form-group col-md-12" style="margin-top:10px;">
                                <div class="col-md-12 text-right">
                                    <button type="button" class="btn green" @click="Kaydet">Kaydet</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="../../VueComponents/Filtre.js"></script>
<script src="../../VueComponents/FiltreEk.js?v=1"></script>

<script>
    var vue = new Vue({

        el: "#app",
        name: "OnlineSinavIslem",

        data: {
            TCKIMLIKNO: '',
            OTURUM: '',
            controller: 'OnlineSinavIslem',

            DONEM: '',
            ID_SINAVTURU: 0,
            ID_KADEME3: 0,
            ID_SINAV: 0,

            TARIH: [],
            BASTARIH: undefined,
            BASSAAT: undefined,
            BITTARIH: undefined,
            BITSAAT: undefined,
            ACIKLANMATARIH: undefined,
            ACIKLANMASAAT: undefined,
            BITACIKLANMATARIH: undefined,
            ONLINETEST: false,

            SINAVDETAY: undefined
        },

        mounted() {

            this.TCKIMLIKNO = session.TCKIMLIKNO;
            this.OTURUM = session.OTURUM;

        },

        methods: {

            DonemSelected(val) {
                this.DONEM = val;
                this.ID_SINAVTURU = 0;
                this.ID_SINAV = 0;
            },
            SinavGrupSelected(val) {
                this.ID_KADEME3 = val;
                this.ID_SINAVTURU = 0;
                this.ID_SINAV = 0;
            },
            SinavTuruSelected(val) {
                this.ID_SINAVTURU = val
                this.ID_SINAV = 0;
                if (val == 15) {
                    this.ONLINETEST = true;
                }
                else {
                    this.ONLINETEST = false;
                }
            },
            SinavSelected(val) {
                this.ID_SINAV = val;
            },

            OnlineSinavDetay() {

                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    ID_SINAV: this.ID_SINAV
                };
                vue.SINAVDETAY = undefined;
                ListeTemizle(vue.TARIH);

                WebPost(this, this.controller, "OnlineSinavDetay", p, '', '', function (data, parent) {

                    var veri = JSON.parse(data)[0];
                    if (data != '[]') {


                        $.each(veri.OSDO, (j, el) => {
                            vue.TARIH.push({
                                BASTARIH: el.BASTARIH,
                                BASSAAT : el.BASSAAT,
                                BITTARIH: el.BITTARIH,
                                BITSAAT : el.BITSAAT
                            })
                        });

                        //vue.BASTARIH = veri.BASTARIH;
                        //vue.BASSAAT = veri.BASSAAT;
                        //vue.BITTARIH = veri.BITTARIH;
                        //vue.BITSAAT = veri.BITSAAT;
                        vue.ACIKLANMATARIH = veri.ACIKLANMATARIH;
                        vue.ACIKLANMASAAT = veri.ACIKLANMASAAT;
                        vue.BITACIKLANMATARIH = veri.BITACIKLANMATARIH;

                        vue.SINAVDETAY = veri;

                    }

                });

            },
            Kaydet() {

                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    ID_SINAV: this.ID_SINAV,
                    SQLJSON: JSON.stringify(this.SINAVDETAY)
                };

                
                
                WebPost(this, this.controller, "OnlineSinavDetayKaydet", p, '', '', function (data, parent) {
                    (data)
                        ? Alert_Info("Kayıt İşlemi Tamamlandı")
                        : Alert_Error("Hata...");
                });

            },

        }
    });
</script>
<script src="Scripts/PublicMethods.js"></script>

<script src="assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
<script src="assets/global/plugins/bootstrap-datepicker/locales/bootstrap-datepicker.tr.min.js" type="text/javascript"></script>
<script src="assets/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>