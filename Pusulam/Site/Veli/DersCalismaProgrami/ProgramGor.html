
<link href="../../../assets/global/plugins/nouislider/jquery.nouislider.css" rel="stylesheet" />
<head>
    <script src="../../../Scripts/Rapor/amcharts.js"></script>
    <script src="../../../Scripts/Rapor/jquery.easypiechart.js"></script>
    <script src="../../../Scripts/Rapor/light.js"></script>
    <script src="../../../Scripts/Rapor/serial.js"></script>
    <script src="../../../assets/global/plugins/nouislider/jquery.nouislider.js"></script>
    <script src="../../../Scripts/Rapor/pie.js"></script>
</head>
<style>
    .progressbar {
        width: 400px;
        height: 30px;
    }

    .progressbarlabel {
        width: 300px;
        height: 21px;
        position: absolute;
        text-align: center;
        font-size: small;
    }




    .table > tbody > tr > td, .table > tbody > tr > th, .table > tfoot > tr > td, .table > tfoot > tr > th, .table > thead > tr > td, .table > thead > tr > th {
        font-size: 11px;
    }

    .turuncu {
        background-color: #EA5702;
        color: white;
        font-size: 12px !important;
    }

    .fontsize12 {
        font-size: 12px !important;
    }

    .koyumavi {
        background-color: #0E3170;
        color: white;
    }

    .acikmavi {
        background-color: #2786C3;
        color: white;
    }

    .bordermavi {
        border: #2786C3 1px solid;
        text-align: center;
        color: black;
    }

    .bordersag {
        border-right: #b4d2e6 1px solid;
        text-align: center;
    }

    .analizbaslik {
        background-color: #FFA500 !important;
    }

    .fixed-table-body {
        overflow-x: hidden !important;
    }


    .table > tbody > tr > td, .table > tbody > tr > th, .table > tfoot > tr > td, .table > tfoot > tr > th, .table > thead > tr > td, .table > thead > tr > th {
        font-size: 11px;
    }

    .turuncu {
        background-color: #EA5702;
        color: white;
        font-size: 12px !important;
    }

    .fontsize12 {
        font-size: 12px !important;
    }

    .koyumavi {
        background-color: #0E3170;
        color: white;
    }

    .acikmavi {
        background-color: #2786C3;
        color: white;
    }

    .bordermavi {
        border: #2786C3 1px solid;
        text-align: center;
        color: black;
    }

    .bordersag {
        border-right: #b4d2e6 1px solid;
        text-align: center;
    }

    .analizbaslik {
        background-color: #FFA500 !important;
    }

    .fixed-table-body {
        overflow-x: hidden !important;
    }

    .badgenew {
        color: black !important;
        font-size: 14px !important;
        font-weight: bold;
        float: right;
        height: 23px;
        margin-top: -3px;
        padding-top: 5px;
    }

    @media (max-width: 1510px) {
        .accordion-toggle {
            font-size: 10px;
        }

        .badgenew {
            color: black !important;
            font-size: 10px !important;
            font-weight: bold;
            float: right;
            height: 17px;
            margin-top: -3px;
            padding-top: 2px;
        }
    }

    @media (max-width: 1190px) {
        .accordion-toggle {
            font-size: 10px;
            padding: 10px 0px !important;
        }
    }

    @media (max-width: 1020px) {
        .badge {
            padding: 2px 2px;
        }
    }

    .badge10 {
        background-color: #F31D13 !important;
    }

    .badge20 {
        background-color: #F34713 !important;
    }

    .badge30 {
        background-color: #F37013 !important;
    }

    .badge40 {
        background-color: #F39913 !important;
    }

    .badge50 {
        background-color: #F1CD1C !important;
    }

    .badge60 {
        background-color: #E4DE1C !important;
    }

    .badge70 {
        background-color: #D6EC1B !important;
    }

    .badge80 {
        background-color: #BDF11C !important;
    }

    .badge90 {
        background-color: #95F11C !important;
    }

    .badge100 {
        background-color: #1CF140 !important;
    }

    .red {
        color: red;
    }
</style>
<div class="page-head">
    <!-- BEGIN PAGE TITLE -->
    <div class="page-title col-md-12">
        <h1>
            <small>Program Hazırla</small> <span onclick="YardimGoster(ID_MENU);" class="pull-right" style="cursor:pointer;"><img src="assets/global/img/info.gif" class="info-image-icon" /> </span>
        </h1>
    </div>
    <!-- END PAGE TITLE -->
</div>

<div class="row" id="app">


    <div v-if="divAcDeneme==0">
        <div class="col-md-12">
            <div class="portlet box green-haze dd-item" style="border:none">
                <div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filters' style="cursor:pointer;">
                    <div class="caption">
                        <i class="icon-magnifier"></i>
                        <span class="caption-subject bold uppercase"> Filtreler </span>
                        <span class="caption-helper"></span>
                    </div>
                    <div class='actions'>
                        <a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
                            <i class='fa fa-chevron-down'></i>
                        </a>
                    </div>
                </div>
                <div class="portlet-body form collapse in" id="filters">
                    <form role="form" style="padding:12px 20px">
                        <div class="form-body form-group-lg form-horizontal row" style="padding: 0px;margin-top: 0px !important;">
                            <div class="portlet light col-md-12" id="FiltreDivVeli" style="margin:0px; border-bottom-style: solid;border-bottom-width: 3px;border-bottom-color: rgb(0, 173, 239);"
                                 v-if="ListKullaniciTipi.indexOf(5)>-1">
                                <div class="portlet-body">


                                    <div class="form-inline">
                                        <!--<c-sube controller="VeliProgramGor"
                                                @OnChange="SubeSelected">
                                        </c-sube>
                                        <c-kademe3 controller="VeliProgramGor"
                                                   :idsube="idsube"
                                                   @OnChange="Kademe3Selected">
                                        </c-kademe3>
                                        <c-sinif controller="VeliProgramGor"
                                                 :idsube="idsube"
                                                 :idkademe3="idkademe3"
                                                 @OnChange="SinifSelected">
                                        </c-sinif>-->
                                        <!--<c-ogrenci controller="VeliProgramGor"
                                                   :idsinif="idsinif"
                                                   @OnChange="OgrenciSelected">
                                        </c-ogrenci>-->
                                        <c-ogrenci-veli controller="VeliProgramGor"
                                                        :tc="TCKIMLIKNO"
                                                        @OnChange="OgrenciVeliSelected">
                                        </c-ogrenci-veli>
                                        <input style="float:right;margin: 10px;" type="button" class="btn btn-success" @click="KazanimListele" value="Listele">
                                    </div>
                                </div>
                            </div>

                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>



    <div class="portlet-body form">
        <form role="form">
            <div class="portlet light bordered">
                <div class="portlet-body">
                    <table style="width:15%" class="table table-striped table-bordered table-hover table-checkable">
                        <tr v-for="u in KAZANIMLIST">
                            <th style="text-align:left">Ad Soyad</th>
                            <td>{{u.ADSOYAD}}</td>
                        </tr>
                        <tr v-for="u in KAZANIMLIST">
                            <th style="text-align:left">Şube Ad</th>
                            <td>{{u.SUBEAD}}</td>
                        </tr>
                        <tr v-for="u in KAZANIMLIST">
                            <th style="text-align:left">Sınıf</th>
                            <td>{{u.SINIF}}</td>
                        </tr>
                    </table>
                    <table class="table table-striped table-bordered table-hover table-checkable" id="table_arama">

                        <!--<thead>
                            <tr class="col-md-12" v-for="u in KAZANIMLIST">
                                <th class="col-md-3" style="text-align:left;">Ad Soyad</th>
                                <td class="col-md-9" style="text-align:left;">{{u.ADSOYAD}}</td>
                            </tr>
                            <tr class="col-md-12" v-for="u in KAZANIMLIST">
                                <th class="col-md-3" style="text-align:left;">Şube Ad</th>
                                <td class="col-md-9" style="text-align:left;">{{u.SUBEAD}}</td>
                            </tr>
                            <tr class="col-md-12" v-for="u in KAZANIMLIST">
                                <th class="col-md-3" style="text-align:left;">Sınıf </th>
                                <td class="col-md-9" style="text-align:left;">{{u.SINIF}}</td>
                            </tr>

                        </thead>-->
                        <tbody>
                            <tr v-for="u in KAZANIMLIST">

                                <!--<td v-html="u.AD"></td>-->
                                <td style="text-align:left;" class="col-md-12">
                                    <div v-for="(u,j) in u.PROGRAMLIST">

                                        <div class="col-md-3">
                                            <label style="text-align:left;" v-if="u.TARIH!=(u+1).TARIH">{{u.TARIH}}</label>
                                            <br />
                                            <label style="text-align:left;">{{u.SAAT}}</label>
                                            <br />
                                        </div>
                                        <!--<input type="text" v-model="u.TARIH" v-if="u.TARIH!=(u-1).TARIH" disabled class="form-control" /> <br />-->
                                        <!--<input type="text" v-model="u.SAAT" v-if="u.SAAT!=''" disabled class="form-control" />-->
                                        <div class="col-md-9">
                                            <label style="text-align:right;">Günlük Tekrar</label><br>
                                            <label style="text-align:right;">{{u.AD}}({{u.DERSAD}})</label> <br>
                                            <label style="text-align:right;">Soru Sayısı:{{u.HedefSoru}}</label>
                                            <!--<label style="text-align:right;">{{k.ODEV}}</label>-->

                                            <div v-for="(u,j) in u.LINKLIST">

                                                <label style="text-align:right;">{{u.ODEV}}</label>
                                            </div>
                                            <div v-for="(u,j) in u.YAKLASANODEVLIST">
                                                <div v-if="u.BASLIK!=null">
                                                    <a href="/anasayfa.html#Odev/OgrenciOdevListesi" target="_blank">Yaklaşan Ödev: {{u.BASLIK}}({{u.DERSAD}})</a>
                                                    <!--<label style="text-align:right;">Yaklaşan Ödev: {{u.BASLIK}}</label>-->
                                                </div>
                                            </div>


                                        </div>

                                    </div>
                                    <br>
                                </td>



                            </tr>
                        </tbody>

                    </table>
                </div>
            </div>
        </form>
    </div>



    <div class="col-md-12 row" id="divKonu" v-show="divKonuFiltre==1">
        <div class="col-md-12">
            <div class="portlet box green-haze dd-item" style="border:none">
                <div class="portlet-title dd-handle" data-toggle='collapse' data-target='#filtersKonu' style="cursor:pointer;">
                    <div class="caption">
                        <i class="icon-magnifier"></i>
                        <span class="caption-subject bold uppercase"> Konu Analizi Filtreleri </span>
                        <span class="caption-helper"></span>
                    </div>
                    <div class='actions'>
                        <a href='javascript:;' class='btn btn-default btn-sm' style='border:none;'>
                            <i class='fa fa-chevron-down'></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="unitedty" class="modal fade" tabindex="-1" data-replace="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title">Kazanım Detay</h4>
                </div>
                <div class="modal-body" align="center" valign="middle">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-12">
                                ss
                                >

                                <div class="row">
                                    ">
                                    <div class="form-md-line-input">
                                        <label class="control-label col-md-3" style="vertical-align:middle;">Kazanım Ad</label>
                                        <div class="col-md-9">
                                            <input type="text" v-model="UNITE.UNITEAD" disabled class="form-control" />
                                        </div>
                                    </div>
                                </div>



                                <div class="row">
                                    <c-tarih tarihid="t_verilis"
                                             label="Veriliş Tarihi"
                                             gun="0"
                                             @change-date="VerilisTarihiSelected">
                                    </c-tarih>
                                </div>
                                <div class="row">
                                    <c-saat id="s_zumre"
                                            label="Saat"
                                            :idset="SAAT"
                                            @change-time="SaatSelected">
                                    </c-saat>
                                </div>

                                <div class="row">
                                    <div class="form-md-line-input">
                                        <label class="control-label col-md-3" style="vertical-align:middle;">Hedef Soru</label>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" v-model="ITEM.HEDEFSORU" />
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer margin-right-10">
                    <button type="button" data-dismiss="modal" class="btn dark btn-outline margin-right-10 margin-top-10">Kapat</button>
                    <button type="button" class="btn btn-success btn-outline margin-right-10 margin-top-10" @click="UniteGuncelle()">Kaydet</button>
                </div>
            </div>
        </div>
    </div>

</div>
<script src="../../../VueComponents/Genel.js?v=3"></script>
<script src="../../../VueComponents/SinavFiltreleri.js?v=8"></script>
<script src="../../../VueComponents/KonuAnaliziFiltreleri.js?v=3"></script>
<script src="../../../VueComponents/OgrenciRaporlariFiltreleri.js?v=3"></script>

<script src="/VueComponents/YaziliYoklamaFiltreleri.js?v=3"></script>
<script src="VueComponents/FiltreEk.js?v=001"></script>
<script src="../../../VueComponents/SinavIstatistikFiltreleri.js?v=3"></script>
<script>
    function btnDeneme(item) {
        vue.DenemeGetir(item);
    }
    function btnYazili(item) {
        vue.YaziliGetir(item);
    }
    var tblSorular = null;
    var vue = new Vue({
        el: "#app",
        name: "ProgramHazirlama.html",

        data: {
            ITEM: {},
            UNITE: { ID_DERSUNITE: 0, AD: '', ID_DERS: 0, KOD: '', LINKLIST: [{ LINK: '' }] },
            UNITEGERCEK: { ID_DERSUNITE: 0, AD: '', ID_DERS: 0, KOD: '', LINKLIST: [{ LINK: '' }] },
            UNITEPROGRAMLIST: { PROGRAMLIST: [{ AD: '', HEDEFSORU: '', SAAT: '', TARIH: '' }] },
            //UNITE: {UNITEAD: '',KOD:'' },
            KAZANIMLIST: [],
            KAZANIMLAR: [],
            VERILIS_TARIHI: '',
            SAAT: '',
            TCKIMLIKNO: '',
            LISTE: [],
            divAcDeneme: 0,
            divKonuFiltre: 0,
            idsube: 0,
            idkademe3: 0,
            idsinif: 0,
            tcogrenci: '',
            ListKullaniciTipi: [],
            filtre: [],

            //  UNITE: { ID_DERSUNITE: 0, AD: '', ID_DERS: 0, KOD: '', LINKLIST: [{ LINK: '' }] }
        },
        mounted() {
            var _this = this;



            var p = {
                TCKIMLIKNO: session.TCKIMLIKNO,
                OTURUM: session.OTURUM
            };
            var list = [];
            WebPost(this, "ProgramGor", "KullaniciTipiGetir", p, "#app", "Yükleniyor...", function (data, parent) {
                if (data != null) {
                    $.each(data, function (j, el) {
                        list.push(this.ID_KULLANICITIPI)
                    });
                    parent.ListKullaniciTipi = list;
                    if (list.indexOf(4) > -1) {
                        parent.tcogrenci = session.TCKIMLIKNO;
                        parent.KazanimListele()
                    }
                } else {
                    Alert_Warning("Kullanıcı Bulunamadı..!");
                }
            });
        },

        methods: {
            SubeSelected(item) {
                this.idsube = item;
                this.idkademe3 = 0;
                this.idsinif = 0;
                this.divOgrenci = 0;
                this.divAc = 0;
                this.Sifirla();
            },
            Kademe3Selected(item) {
                this.idkademe3 = item;
                this.idsinif = 0;
                this.divOgrenci = 0;
                this.divAc = 0;
                this.Sifirla();
            },
            SinifSelected(item) {
                this.idsinif = item;
                this.divOgrenci = 0;
                this.divAc = 0;
                this.Sifirla();
            },
            OgrenciSelected(item) {
                this.tcogrenci = item;
                this.Sifirla();

                var _this = this;
                _this.$nextTick(function () {
                    _this.divOgrenci = 1;
                    _this.divAc = 0;
                });
            },
            OgrenciVeliSelected(item) {
                this.tcogrenci = item;
                this.divOgrenci = 1;
                this.divAc = 0;
                this.ID_YAZILI = 0;
            },




            DonemSelected(item) {
                this.DONEM = item;
                this.divAc = 0;
                if (this.divOdevTakibi == 1) {
                    this.OdevTakibiGetir();
                }
            },




            VerilisTarihiSelected(item) {
                this.ITEM.VERILIS_TARIHI = item;
            },
            SaatSelected(item) {
                this.ITEM.SAAT = item;
            },

            distinct(data, key) {
                var distList = [];
                $.each(data, function (j, item) {
                    if (distList.indexOf(item[key]) == -1) {
                        distList.push(item[key]);
                    }
                });
                return distList;
            },
            getObjects(obj, key, val) {
                var objects = [];
                for (var i in obj) {
                    if (!obj.hasOwnProperty(i)) continue;
                    if (typeof obj[i] == 'object') {
                        objects = objects.concat(this.getObjects(obj[i], key, val));
                    } else if (i == key && obj[key] == val) {
                        objects.push(obj);
                    }
                }
                return objects;
            },





            Sifirla() {
                this.divAcYazili = 0;
                this.divAcDeneme = 0;
                this.divAcKonu = 0;
                this.divAraKarne = 0;
                this.divGelisimRaporu = 0;
                this.divGelisimRaporuOO = 0;
                this.divAcYazili = 0;
                this.divAcDeneme = 0;
                this.divAcKonu = 0;
                this.divKonuFiltre = 0;
                this.divOdevTakibi = 0;
                this.divOdevTakibiFiltre = 0;

                this.htmlDeneme = "",

                    $("#cmbRaporTur").val(0);

                $("#cmbRaporTur").selectpicker('refresh');
            },

            UniteGetir() {
                this.JSONUNITE = [];
                console.log(tblSorular);
                if (tblSorular != null) {
                    tblSorular.rows().remove().draw();
                    tblSorular.destroy();
                }
                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    ID_DERS: this.ID_DERS,
                    ID_KADEME3: this.ID_KADEME3
                };
                WebPost(this, "KazanimOdevAtama", "DersUniteGetir", p, '', '', function (data, parent) {
                    if (data != null) {
                        parent.JSONUNITE = JSON.parse(data);
                        console.log(parent.JSONUNITE);
                        //DOM update olmasını bekleyip update olunca listeyi oluşturuyor.
                        Vue.nextTick(function () {
                            parent.ListeOlustur();
                        })
                    }
                    else {
                        Alert_Warning("Liste Bulunamadı!");
                    }
                })
            },
            ListeOlustur() {
                tblSorular = $('#tblSorular').DataTable(
                    {
                        "columnDefs": [{ "width": "25%", "targets": 0 }],
                        "aoColumnDefs": [{ "aTargets": [0] }],
                        "aaSorting": [[0, 'asc']],
                        language: {
                            "url": "./Utility/dil.json"
                        }
                    });
            },


            GeriDeneme() {
                this.Tbl = 1;
                this.divAcDeneme = 0;
            },





            KazanimListele() {

                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    OGRTCKIMLIKNO: this.tcogrenci,
                    //ID_SINIF: this.idsinif,
                    //ID_SUBE: this.idsube
                };
                //if (this.idsube == "" || this.idsinif == "" || this.idkademe3 == "" || this.tcogrenci == "") {
                //    Alert_Warning("Sınıf , Şube,Kademe ve Öğrenci Seçimlerini Yapınız...");
                //    return;
                //}
                WebPost(this, "ProgramGor", "ProgramListele", p, '', '', function (data, parent) {
                    vue.KAZANIMLIST = JSON.parse(data);
                    vue.KAZANIMLAR = JSON.parse(data);
                    // vue.UNITEPROGRAMLIST = JSON.parse(JSON.stringify(data.KAZANIMLIST));

                })
            },

            OdevEkleDuzelt(UNITE) {
                this.UNITEGERCEK = { ID_DERSUNITE: 0, AD: '', ID_DERS: 0, KOD: '', LINKLIST: [{ LINK: '' }] };
                this.UNITEGERCEK = UNITE;
                this.UNITE = JSON.parse(JSON.stringify(UNITE));

                $("#unitedty").modal();


            },
            UniteGuncelle() {


                var p = {
                    TCKIMLIKNO: session.TCKIMLIKNO,
                    OTURUM: session.OTURUM,
                    ID_DERS: this.ID_DERS,
                    ID_KADEME3: this.idkademe3,
                    //KOD: this.UNITE.KOD,
                    AD: this.UNITE.UNITEAD,
                    KOD: this.UNITE.UNITEKOD,
                    //AD: this.UNITE.AD,
                    TC_OGRENCI: this.tcogrenci,
                    ID_DERSUNITE: this.UNITE.ID_DERSUNITE,
                    LINKLIST: JSON.stringify(this.UNITE),
                    SQLJSON: JSON.stringify(this.ITEM)
                };

                if (this.ITEM.VERILIS_TARIHI == "") {
                    Alert_Warning("Tarih Seçimi zorunludur");
                    return;
                }

                if (p.AD != "" && p.KOD != "") {
                    console.log(p);
                    WebPost(this, "ProgramHazirla", "ProgramEkle", p, '', '', function (data, parent) {
                        if (data == true) {
                            Alert_Info("Program Ekleme İşlemi Başarılı");
                            $("#unitedty").modal("hide");
                            Vue.nextTick(function () {

                                parent.UNITEGERCEK.CALISMASAYISI++;
                                //parent.UNITEGERCEK = {};
                                parent.ITEM.HEDEFSORU = "";
                                console.log(parent.UNITE);
                                //parent.UniteGetir();
                            })
                        }
                        else {
                            Alert_Warning("Program Ekleme işlemi Başarısız");
                        }
                    })
                }
                else {
                    Alert_Warning("Alanları boş geçmeyin!");
                }

            },

            DetayGoster(k) {

                this.SECILIKAZANIM = k;
                this.$nextTick(function () {
                    $('#kazanim_modal').modal();
                });
            }



        },
    });
</script>
<script src="../../../Scripts/PublicMethods.js"></script>
<script src="../../../Scripts/Rapor/amcharts.js"></script>